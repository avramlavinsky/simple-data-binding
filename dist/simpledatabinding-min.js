!function(){function e(t,n,r,a,o){var i,c=this,d=document;this.set=function(e,t,n,r,a){var o,i=c;if(e=b(e),r=r||"data",o=c.data[e],a){for(;void 0===o&&n!==!1&&i.parent;)i=i.parent,o=i[r][e];void 0===o?c[r][e]=t:i[r][e]=t}else c[r][e]=t;return c[r][e]},this.get=function(e,t,n){var r,a=c;for(e=b(e),n=n||"data",r=c[n][e];void 0===r&&t!==!1&&a.parent;)a=a.parent,r=a[n][e];return r},this.update=function(e,t){var n,r;t||Z();for(var a in e)e.hasOwnProperty(a)&&(n=e[a],"object"==typeof n?n instanceof Array?c.updateChildArray(a,n):c.createChild(a,I(a),n):(r=n,a=b(a),c.root.lastMutation={value:r,oldValue:c.get(a),prop:a},c.set(a,r),c.checkWatches(a)));return c.parseNode(c.container),c.checkWatches("*",!1),c.root.initialized&&_(),c.data},this.removeChild=function(e){return W(e),delete c.children[e.id],e.removed=!0,e};var u=function(e){function t(t,n){for(var r=0,a=e.$bindings.length;r<a;r++)e.$bindings[r]&&e.$bindings[r].set&&e.$bindings[r].set(t,n);return n}function n(t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,value:n})}return e&&(e.$bindings?e.$bindings.push(c):(n("$bindings",[c]),n("$set",t)),n("$binding",c)),e},l=function(e,t,n){var r,a=c.configs.modifyInputArrays===!0?t:[];return c.childArrays[e]=a,a.idIndex=0,a.ownerInstance=c,a.id=e,r=n||I(e),c.surroundByComments(a,"child array "+e,r),a},s=function(e,t,n,r){var a,o,i;for(a=0,o=r.priorState.length;a<o;a++)t.indexOf(r.priorState[a])===-1&&c.removeChild(r.priorState[a]);if(!document.body.contains(r.placeholderNode)){if(i=n||I(e),!i)return null;c.surroundByComments(r,"child array "+e,i)}r.ownerInstance=c};this.updateChildArray=function(e,t,n){var r=c.childArrays[e],a=document.createDocumentFragment();r?s(e,t,n,r):r=l(e,t,n);for(var o=0,i=t.length;o<i;o++)r[o]=c.createChildArrayMember(r,t[o],a);return r.priorState=r.slice(),E(r,a),c.arrayEnhancer&&!r.update&&c.arrayEnhancer.enhance(r),r},this.createChildArrayMember=function(t,n,r){var a,o=c.cache.get(n);return n instanceof e?(o=n,O(o.container,r)):o&&o.removed?(c.createChild(o.id,o.container,n),O(o.container,r)):(a=O(x(t),r),o=c.createChild(p(t,n),a,n),o.containingArray=t),o};var p=function(e,t){var n=t.name||t.id||t.heading||t.value||t.label;return n&&!c.children[n]||(e.idIndex++,n=(n||e.id)+e.idIndex),n},f=function(){var e=a,t=(new Date).getTime().toString();return c.container&&(e||(e=c.container.getAttribute("databind")||c.container.id||c.container.name||"binding-"+c.container.tagName+"-"+t),c.container.setAttribute("databind",e)),e||t},h=Object.assign||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e};this.createChild=function(t,n,r){var a,o=null;return a=c.cache.get(r),a&&n&&a.removed?(a.container=n,a.update(r),a.removed=!1,o=a):o=new e(n,r,c.configs,t,c),c.children[t]=o,o};var m=function(e,t,n){var r,a=c.children,o=c.childArrays;if(n=n||(c.found=[])&&c,a[e]&&c.root.found.push(a[e]),o[e]&&c.root.found.push(o[e]),t||!c.root.length)for(r in a)a.hasOwnProperty(r)&&a[r].find(e,t,n);return t?c.root.found:c.root.found[0]};this.find=function(e){return m(e)},this.findAll=function(e){return m(e,!0)},this.getBindingFor=function(e){var t=C(e,"[databind]"),n=t&&t.getAttribute("databind"),r=c.root.findAll(n);return r.filter(function(e){return e.container===t})[0]},this.export=function(e){var t=h({},c.data);e&&(t=A(t));for(var n in c.children)c.children.hasOwnProperty(n)&&c.children[n]&&(t[n]=c.children[n].export());return t};var g=function(e){return e.replace(/-([a-z])/gi,function(e,t){return t.toUpperCase()})},v=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},b=function(e){return c.nameSpace&&e&&e.substring(0,c.nameSpace.length)!==c.nameSpace&&(e=c.nameSpace+e.charAt(0).toUpperCase()+e.slice(1)),e},N=function(e){return(c.attrPrefix?v(c.attrPrefix)+"-":"")+e},y=function(e){return c.nameSpace?(e=e.substring(c.nameSpace.length),e.charAt(0).toLowerCase()+e.slice(1)):e},S=function(e){if(c.nameSpace)for(var t in e)t.substring(0,c.nameSpace.length)!==c.nameSpace&&(c.set(t,e[t]),delete e[t]);return e},A=function(e){if(c.nameSpace)for(var t in e)e.hasOwnProperty(t)&&(e[y(t)]=e[t],delete e[t]);return e},w=function(e,t){var n=!!e&&(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector);return n&&n.call(e,t)},C=function(e,t){for(;!w(e,t)&&e!==d.body;)e=e.parentElement;return e},O=function(e,t){return t&&t.appendChild(e)},x=function(e){return e.elementTemplate.cloneNode(!0)},E=function(e,t){var n=e.placeholderNode;return n.parentNode.insertBefore(t,n),n},T=function(e){var t;return"radio"===e.type?e.checked&&(t=e.value):"checkbox"===e.type?(t=c.get(e.name,!0),t=void 0!==t?t.split(c.checkboxDataDelimiter):[],e.checked?t.push(e.value):t.splice(t.indexOf(e.value),1),t=t.join(c.delimiter)):"OPTION"===e.tagName?(t=c.get(e.name,!0),t=void 0!==t?t.split(c.checkboxDataDelimiter):[],e.selected?t.push(e.value):t.splice(t.indexOf(e.value),1),t=t.join(c.delimiter)):t=e.value,t},k=function(e){if("undefined"!==e.name&&"radio"!==e.type&&"checkbox"!==e.type&&"OPTION"!==e.tagName){var t=e.getAttribute("value");if(t&&"{{"!==t.substr(0,2))return c.set(e.name,T(e))}},P=function(){var e,t="[name]";if("form"===c.container.tagName)for(var n in c.container.elements)c.container.elements.hasOwnProperty(n)&&k(c.container.elements[n]);else{e=Array.prototype.slice.call(c.container.querySelectorAll(t)),w(c.container,t)&&e.push(c.container);for(var r=0,a=e.length;r<a;r++)k(e[r])}return c.data},M=function(){var e=o&&o.container||d;return t&&(c.container=t.tagName?t:e.querySelector(t)),a&&!c.container&&(c.container=e.querySelector("["+N("databind")+'="'+a+'"]')),c.container||o||(c.container=d.querySelector("["+N("databind")+"]")||d.forms[0]||d.body),c.container},I=function(e){var t=c.container.querySelector("["+N("databind")+'="'+e+'"]');return t},B=function(){var e;return c.configs.useHiddenInput&&(e=d.createElement("input"),e.type="hidden",(c.container||d).appendChild(e)),e};this.surroundByComments=function(e,t,n,r){return e.placeholderNode&&document.body.contains(e.placeholderNode)||(e.elementTemplate=n,e.placeholderNode=d.createComment("end "+t),n.placeholderNode=e.placeholderNode,n.parentNode.insertBefore(d.createComment("start "+t),n),n.nextElementSibling?n.parentNode.insertBefore(e.placeholderNode,n.nextElementSibling):n.parentNode.appendChild(e.placeholderNode),r||n.parentNode.removeChild(n)),e.placeholderNode},this.removeCommentedElements=function(e,t){for(;e.previousSibling&&8!==e.previousSibling.nodeType;)1!==e.previousSibling.nodeType||t&&null===e.previousSibling.getAttribute(t)?e=e.previousSibling:e.parentNode.removeChild(e.previousSibling);return e};var W=function(e){var t=e.container;t&&t.parentNode&&t.parentNode.removeChild(t)};this.parseNode=function(e){var t;if(e.parsed)return!1;if(3===e.nodeType)L(e);else if(1===e.nodeType){for(t=0;t<e.attributes.length;t++)D(e.attributes[t]);for(t=0;t<e.childNodes.length;t++)e.childNodes[t].hasAttribute&&e.childNodes[t].hasAttribute("databind")||c.parseNode(e.childNodes[t]);e.getAttribute("databind")&&setTimeout(function(){e.classList.remove("unparsed"),e.classList.add("parsed")},0)}return e.parsed=!0,e};var D=function(e){if("data-"!==e.nodeName.substr(0,5))return V(e),$(e),e},V=function(e){var t;return void 0===e.rawName&&("__"===e.nodeName.substr(-2,2)?(e.rawName=e.nodeName.slice(2,-2),e.originalEl=e.ownerElement,e.prevAttrName=e.nodeName):e.rawName=null),null!==e.rawName&&(t=q(b(g(e.rawName)),e),t!==e.prevAttrName&&(t&&e.originalEl.setAttribute(t,e.nodeValue),e.prevAttrName&&e.originalEl.removeAttribute(e.prevAttrName),e.prevAttrName=t)),t},$=function(e){var t,n,r,a=e.nodeName,o=c.attrMethods[a],i=e.ownerElement;return L(e,e.nodeValue),n=e.value||i&&i[e.name],"value"!==a||"radio"!==i.type&&"checkbox"!==i.type&&"OPTION"!==i.tagName||(r=i&&i.name,!r&&"OPTION"===i.tagName&&i.parentNode&&(t=i.parentNode instanceof DocumentFragment?"SELECT"===c.parent.container.tagName?c.parent.container:c.parent.container.querySelector("select"):i.parentNode,r=t.name),H(i,q(r,e,!1),r,"name")),o&&o.apply(c,[i,q(e.nodeValue,e),e.nodeValue,e.nodeName]),e},L=function(e){if(!e)return"";var t=void 0===e.nodeTemplate,n=e.nodeValue;return t&&("string"==typeof n&&n.indexOf("{{")!==-1?e.nodeTemplate=n:e.nodeTemplate=null),e.nodeTemplate&&(e.nodeValue=e.nodeTemplate.replace(/{{(.*?)}}/g,function(t){return q(t.slice(2,-2),e)})),e.nodeValue},j=function(e,t,n){if("this."===e.substr(0,5)){var r,a,o,i,d=e.indexOf("("),u=d>0&&e.slice(d+1,-1).split(","),l=e.substr(0,d===-1?e.length:d),s=c;for(r=l.split("."),o=1,i=r.length;o<i;o++)s&&(s=s[r[o]]);return"function"==typeof s?(a=function(){var e=[];for(o=0,i=u.length;o<i;o++)e[o]=q(u[o].trim(),t);return s.apply(c,e)},n!==!1&&c.watch(u,a),a):s}return null},q=function(e,t,n){if(!e)return e;var r,a,o="'"===e.substr(0,1)&&e.slice(1,-1),i=Number(e);return o?o:isNaN(i)?(r=j(e,t,n),r?a="function"==typeof r?r():r:(a=c.get(e,!0),n!==!1&&c.watch(e,t)),t&&"name"===t.nodeName&&a&&n!==!1&&c.watch(a,t),a):i};this.templateMaster=function(e){return function(t,n){var r,a,o;return n&&(r=c.root.templates[n],o=r||d.getElementById(n),o&&("TEMPLATE"===o.tagName?(o=o.content||o.firstElementChild,o instanceof DocumentFragment&&(o=o.firstElementChild)):r||o.removeAttribute("id"),c.root.templates[n]=o,a=o.cloneNode(!0),t.placeholderNode?(c.removeCommentedElements(t.placeholderNode),t.placeholderNode.parentNode.insertBefore(a,t.placeholderNode)):(e(t,a),c.surroundByComments(t,"template "+n,a,!0)),c.parseNode(a))),t}};var z=c.templateMaster(function(e,t){return e.appendChild(t)}),F=function(e,t,n){return this.surroundByComments(e,"render if "+n,e,!0),t&&!e.parentElement?e.placeholderNode.parentNode.insertBefore(e,e.placeholderNode):!t&&e.parentElement&&e.parentElement.removeChild(e),e},H=function(e,t,n,r){return void 0!==t&&("radio"===e.type&&"name"===r?e.checked=t===e.value:"checkbox"===e.type&&"name"===r?e.checked=t.indexOf(e.value)!==-1:"SELECT"!==e.tagName||t?"OPTION"!==e.tagName||"value"!==r&&"name"!==r?e.value=t:e.selected=e.value&&t.indexOf(e.value)!==-1:setTimeout(function(){e.selectedIndex="-1"},0)),e},U=function(e){return c.container&&(i=new MutationObserver(G),c.container.addEventListener("change",J),c.container.addEventListener("search",J),e!==!1&&c.container.addEventListener("keyup",J),c===c.root&&(c.turnOnAllBindings(),setTimeout(function(){c.turnOnAllBindings()}))),c},_=function(){return i&&i.observe(c.container,{attributes:!0,attributeOldValue:!0}),i};this.turnOnAllBindings=function(){_();for(var e in c.children)c.children.hasOwnProperty(e)&&c.children[e]&&c.children[e].turnOnAllBindings();return c};var Z=function(){return i&&i.disconnect(),i},G=function(e){return e.forEach(function(e){if(e.target===(c.boundHiddenInput||c.container)){var t,r="data-",a=e.target.getAttribute(e.attributeName);e.attributeName.substr(0,r.length)===r&&a!==e.oldValue&&(t=g(e.attributeName.substr(r.length)),c.root.lastMutation={prop:t,value:a,oldValue:e.oldValue},c.checkWatches(t),c.checkWatches("*"),c.configs.modifyInputObjects&&(n[t]=a))}}),e},J=function(e){var t=T(e.target),n=e.target.name;return e.stopPropagation(),!c.containingArray||void 0===c.parent.get(n)||"radio"!==e.target.type&&"checkbox"!==e.target.type?c.set(n,t,!0,"data",!0):c.parent.set(n,t,!0,"data",!0)};this.watch=function(e,t,n){var r,a,o=["*"];"string"==typeof e&&(e=[e]),e instanceof Array||(n=t,t=e,e=o),e=e||o,r=n?c.root:c,a=n?"globalScopeWatches":"watches";for(var i=0,d=e.length;i<d;i++)r[a][e[i]]=r[a][e[i]]||[],r[a][e[i]].indexOf(t)===-1&&r[a][e[i]].push(t);return r[n?"globalScopeWatches":"watches"]};var K=function(e,t){var n,r=t?c.root:c,a=t?"globalScopeWatches":"watches",o=r[a][e];if(o)for(var i=o.length-1;i>=0;i--)"function"==typeof o[i]?Q(o[i]):(n=o[i],2===n.nodeType?D(n):L(n));return r};this.checkWatches=function(e,t){if(c.removed)return!1;if(c.watches[e]&&(K(e,!1),K("*",!1),c.root.globalScopeWatches[e]&&K(e,!0),c.root.globalScopeWatches["*"]&&K("*",!0)),t!==!1)for(var n in c.children)c.children.hasOwnProperty(n)&&c.children[n]&&c.children[n].checkWatches(e);return e};var Q=function(e){var t=c.root.lastMutation,n=[t.value,t.oldValue,t.prop];if(void 0!==c.get(t.prop))return e.apply(c,n)},R=function(){return c.configs=r||{},c.nameSpace="string"==typeof c.configs.nameSpace?c.configs.nameSpace:"",c.attrPrefix="string"==typeof c.configs.attrPrefix?c.configs.attrPrefix:"",c.container=M(),c.id=f(),c.boundHiddenInput=B(),c.watches=c.configs.watches||{},c.globalScopeWatches=c.configs.globalScopeWatches||{},c.checkboxDataDelimiter=c.configs.checkboxDataDelimiter||",",c.attrMethods=h({},c.configs.attrMethods||{}),c.attrMethods.name=H,c.attrMethods[N("renderif")]=F,c.attrMethods[N("childtemplate")]=z,c.templates=h({},c.configs.templates||{}),c.logic=h({},c.configs.logic||{}),c.cache=new WeakMap,c},X=function(){return c.parent=o,c.parent?(c.ancestors=c.parent.ancestors.slice(),c.ancestors.push(o)):c.ancestors=[],c.root=c.ancestors[0]||c,c.children={},c.childArrays={},c},Y=function(){var e=c.boundHiddenInput||c.container;return e&&(n&&c.parent&&c.parent.cache.set(n,c),c.data=S(e.dataset),c.update(c.data),P(),c.update(n||{}),u(n)),c};this.init=function(){return X(),R(),Y(),U(this.configs.keyUp),c.initialized=!0,this},this.init()}window.SimpleDataBinding=e}();