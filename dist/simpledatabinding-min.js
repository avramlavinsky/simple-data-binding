function SimpleDataBinding(e,t,n,r){var a=this;this.set=function(e,t,n,r){var i,o=a;for(e=a.toPrefixedCamel(e),r=r||"data",i=a.data[e];void 0===i&&n!==!1&&o.parent;)o=o.parent,i=o[r][e];return void 0===i?a[r][a.toPrefixedCamel(e)]=t:o[r][a.toPrefixedCamel(e)]=t,a[r][e]},this.get=function(e,t,n){var r,i=a;for(e=a.toPrefixedCamel(e),n=n||"data",r=a[n][e];void 0===r&&t!==!1&&i.parent;)i=i.parent,r=i[n][e];return r},this.update=function(e,t,n){var r,i;t||a.turnOffBindings();for(var o in e)"object"==typeof e[o]?(r=a.childArrays[o]&&a.childArrays[o].elementTemplate||a.container.querySelector("["+a.toPrefixedHyphenated("databind")+'="'+o+'"]'),e[o]instanceof Array&&r?a.updateChildArray(o,r,e,n):a.createChild(o,r,e[o])):(i=e[o],o=a.toPrefixedCamel(o),a.root.lastMutation={value:i,oldValue:a.get(o),prop:o},a.set(o,i),a.checkWatches(o));return a.parseNode(a.container),a.checkWatches("*",!1),a.root.initialized&&a.turnOnBindings(),a.data},this.updateChildArray=function(e,t,n,r){var i,o,s,d=!1;a.childArrays[e]?r!==!0&&(a.removeCommentedElements(a.childArrays[e].placeholder,"databind",e),a.childArrays[e].length=0):(a.childArrays[e]=[],a.childArrays[e].idIndex=0,a.childArrays[e].ownerInstance=a,a.childArrays[e].key=e,a.surroundByComments(a.childArrays[e],"child array "+e,t)),d&&(i=a.childArrays[e].placeholder.parentElement,o=i.nextElementSibling,s=i.parentElement,s.removeChild(i));for(var l=0,c=n[e].length;l<c;l++)a.childArrays[e].push(a.createChildArrayMember(a.childArrays[e],n[e][l],t));return a.arrayEnhancer&&a.arrayEnhancer.enhance(a.childArrays[e]),d&&(o?o.parentNode.insertBefore(i,o):s.appendChild(i)),a.childArrays[e]},this.createChildArrayMember=function(e,t,n,r){var i=a.generateChildArrayMemberId(e,t),o=a.cloneInPlace(n||e.elementTemplate,r||e.placeholder),s=a.createChild(i,o,t);return s.containingArray=e,s},this.generateChildArrayMemberId=function(e,t){var n=t.name||t.id||t.value;return n&&!a.children[n]||(n=(n||e.key)+e.idIndex,e.idIndex++),n},this.assign=Object.assign||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},this.createChild=function(e,t,n){return a.children[e]=new SimpleDataBinding(t,n,a.configs,a),a.children[e]},this.export=function(e){var t=a.assign({},a.data);e&&(t=a.unprefixData(t));for(var n in a.children)a.hasOwnProperty(n)&&(t[n]=a.children[n].export());return t},this.toCamelCase=function(e){return e.replace(/-([a-z])/gi,function(e,t){return t.toUpperCase()})},this.toHyphenated=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},this.toPrefixedCamel=function(e){return a.nameSpace&&e&&e.substring(0,a.nameSpace.length)!==a.nameSpace&&(e=a.nameSpace+e.charAt(0).toUpperCase()+e.slice(1)),e},this.toPrefixedHyphenated=function(e){return(a.attrPrefix?a.toHyphenated(a.attrPrefix)+"-":"")+e},this.toUnprefixedCamel=function(e){return a.nameSpace?(e=e.substring(a.nameSpace.length),e.charAt(0).toLowerCase()+e.slice(1)):e},this.prefixData=function(e){if(a.nameSpace)for(var t in e)t.substring(0,a.nameSpace.length)!==a.nameSpace&&(a.set(t,e[t]),delete e[t]);return e},this.unprefixData=function(e){if(a.nameSpace)for(var t in e)e.hasOwnProperty(t)&&(e[a.toUnprefixedCamel(t)]=e[t],delete e[t]);return e},this.is=function(e,t){var n=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector;if(n)return n.call(e,t);for(var r=e.parentNode.querySelectorAll(t),a=r.length;a--;)if(r[a]===e)return!0;return!1},this.closest=function(e,t){for(;!a.is(e,t)&&e!==document.body;)e=e.parentElement;return e},this.cloneInPlace=function(e,t){var n=e.cloneNode(!0);return t.parentNode.insertBefore(n,t),n},this.getNodeValue=function(e){var t;return"radio"===e.type?e.checked&&(t=e.value):"checkbox"===e.type?(t=a.get(e.name,!0),t=void 0!==t?t.split(a.checkboxDataDelimiter):[],e.checked?t.push(e.value):t.splice(t.indexOf(e.value),1),t=t.join(a.delimiter)):"OPTION"===e.tagName?(t=a.get(e.name,!0),t=void 0!==t?t.split(a.checkboxDataDelimiter):[],e.selected?t.push(e.value):t.splice(t.indexOf(e.value),1),t=t.join(a.delimiter)):t=e.value,t},this.getInitialNodeValues=function(){function e(e){if("undefined"!==e.name&&"radio"!==e.type&&"checkbox"!==e.type&&"OPTION"!==e.tagName){var t=e.getAttribute("value");t&&"{{"!==t.substr(0,2)&&a.set(e.name,a.getNodeValue(e))}}var t,n="[name]";if("form"===a.container.tagName)for(var r in a.container.elements)a.container.elements.hasOwnProperty(r)&&e(a.container.elements[r]);else{t=Array.prototype.slice.call(a.container.querySelectorAll(n)),a.is(a.container,n)&&t.push(a.container);for(var i=0,o=t.length;i<o;i++)e(t[i])}return a.data},this.surroundByComments=function(e,t,n,r){return e.placeholder||(e.elementTemplate=n,e.placeholder=document.createComment("end "+t),n.placeholder=e.placeholder,n.parentNode.insertBefore(document.createComment("start "+t),n),n.nextElementSibling?n.parentNode.insertBefore(e.placeholder,n.nextElementSibling):n.parentNode.appendChild(e.placeholder),r||n.parentNode.removeChild(n)),e.placeholder},this.removeCommentedElements=function(e,t,n){for(;e.previousSibling&&8!==e.previousSibling.nodeType;)1===e.previousSibling.nodeType&&e.previousSibling.getAttribute(t)===n?e.parentNode.removeChild(e.previousSibling):e=e.previousSibling;return e},this.parseNode=function(e){var t;if(e.parsed)return!1;if(3===e.nodeType)a.resolveDoubleCurlyBraces(e);else if(1===e.nodeType){for(t=0;t<e.attributes.length;t++)a.resolveAttrNode(e.attributes[t]);for(t=0;t<e.childNodes.length;t++)e.childNodes[t].hasAttribute&&e.childNodes[t].hasAttribute("databind")||a.parseNode(e.childNodes[t])}return e.parsed=!0,e},this.resolveAttrNode=function(e){if("data-"!==e.nodeName.substr(0,5))return a.resolveAttrNodeName(e),a.resolveAttrNodeValue(e),e},this.resolveAttrNodeName=function(e){var t,n;return void 0===e.boundAttrNameProp&&("__"===e.nodeName.substr(-2,2)?(t=a.toPrefixedCamel(e.nodeName.slice(2,-2)),t&&(e.boundAttrNameProp=t,a.addWatch(e.boundAttrNameProp,e))):e.boundAttrNameProp=null),e.boundAttrNameProp&&(n=a.get(e.boundAttrNameProp,!0),n?(e.boundAttrName=n,setTimeout(function(){e.ownerElement.setAttribute(n,e.nodeValue)})):e.boundAttrName&&e.ownerElement.removeAttribute(e.boundAttrName)),e},this.resolveAttrNodeValue=function(e){var t,n,r=e.nodeName,i=a.attrMethods[r];return a.resolveDoubleCurlyBraces(e,e.nodeValue),t=e.value||e.ownerElement[e.name],n=t||"*","value"!==r||"radio"!==e.ownerElement.type&&"checkbox"!==e.ownerElement.type&&"OPTION"!==e.ownerElement.tagName||a.setNodeValue(e.ownerElement,e.ownerElement.getAttribute("name"),"name"),i&&(a.addWatch(a.toPrefixedCamel(n),e),i.apply(a,[e.ownerElement,e.nodeValue,e.nodeName,a.get(e.nodeValue)])),e},this.resolveDoubleCurlyBraces=function(e,t){if(!e)return"";var n=void 0===e.nodeTemplate;return n&&(t=t||e.nodeValue,"string"==typeof t&&t.indexOf("{{")!==-1?e.nodeTemplate=t:e.nodeTemplate=null),e.nodeTemplate&&(e.nodeValue=e.nodeTemplate.replace(/{{(.*?)}}/g,function(t){var r=a.toPrefixedCamel(t.slice(2,-2)),i=a.get(r,!0)||"";return n&&a.addWatch(r,e),"name"===e.nodeName&&i&&a.addWatch(i,e),i})),e.nodeValue},this.childTemplate=function(e,t,n,r){var i;return r&&(a.templates[r]=a.templates[r]||document.getElementById(r),a.templates[r]&&(i=a.templates[r].cloneNode(!0),i.removeAttribute("id"),e.appendChild(i),this.parseNode(i),this.childFromTemplate=i)),e},this.renderIf=function(e,t,n,r){return this.surroundByComments(e,"render if "+t,e,!0),r&&!e.parentElement?e.placeholder.parentNode.insertBefore(e,e.placeholder):!r&&e.parentElement&&e.parentElement.removeChild(e),e},this.setNodeValue=function(e,t,n){var r=a.get(t,!0);return void 0!==r&&("radio"===e.type&&"name"===n?e.checked=r===e.value:"checkbox"===e.type&&"name"===n?e.checked=r.indexOf(e.value)!==-1:"SELECT"!==e.tagName||r?"OPTION"===e.tagName&&"value"===n?e.selected=(a.get(e.parentElement.name)||"").indexOf(e.value)!==-1:e.value=r:setTimeout(function(){e.selectedIndex="-1"},0)),e},this.setListeners=function(e){return a.observer=new MutationObserver(a.mutationHandler),a.container.addEventListener("change",a.changeHandler),e!==!1&&a.container.addEventListener("keyup",a.keyUpHandler),a},this.turnOnBindings=function(){return a.observer&&a.observer.observe(a.container,{attributes:!0,attributeOldValue:!0}),a.observer},this.turnOnAllBindings=function(){a.turnOnBindings();for(var e in a.children)a.children.hasOwnProperty(e)&&a.children[e].turnOnAllBindings();return a},this.turnOffBindings=function(){return a.observer&&a.observer.disconnect(),a.observer},this.mutationHandler=function(e){return e.forEach(function(e){if(e.target===(a.boundHiddenInput||a.container)){var t,n="data-",r=e.target.getAttribute(e.attributeName);e.attributeName.substr(0,n.length)===n&&r!==e.oldValue&&(t=a.toCamelCase(e.attributeName.substr(n.length)),a.root.lastMutation={prop:t,value:r,oldValue:e.oldValue},a.checkWatches(t),a.checkWatches("*"))}}),e},this.keyUpHandler=function(e){var t=document.createEvent("HTMLEvents");return t.initEvent("change",!0,!1),e.target.dispatchEvent(t),t},this.changeHandler=function(e){var t=a.getNodeValue(e.target),n=e.target.name;return e.stopPropagation(),!a.containingArray||void 0===a.parent.get(n)||"radio"!==e.target.type&&"checkbox"!==e.target.type?a.set(n,t):a.parent.set(n,t)},this.watch=function(e,t,n){var r,i=["*"];"function"==typeof e?(n=t,t=e,e=i):"string"==typeof e&&(e=[e]),e=e||i,r=n?a.root:a;for(var o=0,s=e.length;o<s;o++)r.addWatch(e[o],{fn:t,props:e},n);return r[n?"globalScopeWatches":"watches"]},this.addWatch=function(e,t,n){var r=n?"globalScopeWatches":"watches",i=n?a.root:a;return i[r][e]=i[r][e]||[],i[r][e].indexOf(t)===-1&&i[r][e].push(t),t},this.checkWatches=function(e,t){function n(e,t){var n,r=t?a.root:a,i=t?"globalScopeWatches":"watches",o=r[i][e];if(o)for(var s=o.length-1;s>=0;s--)o[s].fn?a.executeWatchFn(o[s],e):(n=o[s],2===n.nodeType?a.resolveAttrNode(n):a.resolveDoubleCurlyBraces(n))}if(a.watches[e]&&(n(e,!1),n("*",!1),a.root.globalScopeWatches[e]&&n(e,!0),a.root.globalScopeWatches["*"]&&n("*",!0)),t!==!1)for(var r in a.children)a.children.hasOwnProperty(r)&&a.children[r].checkWatches(e);return e},this.executeWatchFn=function(e){var t=a.root.lastMutation,n=[t.value,t.oldValue,t.prop],r={};if(void 0!==a.get(t.prop)||!e.recursive){if("*"!==e.props[0]){for(var i=0,o=e.props.length;i<o;i++)r[e.props[i]]=a.get(e.props[i]);n.push(r)}return e.fn.apply(a,n)}},this.initProps=function(){return this.configs=n||{},this.nameSpace="string"==typeof this.configs.nameSpace?this.configs.nameSpace:"",this.attrPrefix="string"==typeof this.configs.attrPrefix?this.configs.attrPrefix:"",this.container=e&&e.tagName?e:document.querySelector(e||"["+this.toPrefixedHyphenated("databind")+"]")||document.forms[0]||document.body,this.configs.containInHiddenInput&&(this.boundHiddenInput=document.createElement("input"),this.boundHiddenInput.type="hidden",this.container.appendChild(this.boundHiddenInput)),this.container.getAttribute("databind")||this.container.setAttribute("databind",""),this.watches=this.configs.watches||{},this.globalScopeWatches=this.configs.globalScopeWatches||{},this.checkboxDataDelimiter=this.configs.checkboxDataDelimiter||",",this.attrMethods=this.assign({},this.configs.attrMethods||{}),this.attrMethods.name=this.setNodeValue,this.attrMethods[this.toPrefixedHyphenated("renderif")]=this.renderIf,this.attrMethods[this.toPrefixedHyphenated("childtemplate")]=this.childTemplate,this.templates=this.assign({},this.configs.templates||{}),this},this.initFamilyTree=function(){return this.parent=r,this.parent?(this.ancestors=this.parent.ancestors.slice(),this.ancestors.push(r)):this.ancestors=[],this.root=this.ancestors[0]||this,this.children={},this.childArrays={},this},this.initData=function(){return this.data=this.prefixData((this.boundHiddenInput||this.container).dataset),this.update(this.data),this.getInitialNodeValues(),this.update(t||{}),this},this.init=function(){return this.initFamilyTree(),this.initProps(),this.initData(),this.setListeners(this.configs.keyUp),this===this.root&&this.turnOnAllBindings(),this.initialized=!0,this},this.init()}